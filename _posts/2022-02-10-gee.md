---
title:  "Downloading Landsat Composites from Google Earth Engine"
mathjax: true
layout: post 
categories: 
  - github
  - website
---

It's simple. You only need a few lines of code.  And it's cool that you can stitch a more than one landsat scene to create a mosaiced composite of a large area.   
```
// Script adopted from snippets in API documentation

var Landsat5BandCombo = ['B4', 'B3', 'B2'] // 4,3,2 stack is good for discriminating agriculture

var Landsat5Visualize = {
  bands: Landsat5BandCombo,
  min: 0,
  max: 0.5,
  gamma: [0.95, 1.1, 1]
};

//Function to mask clouds

function maskLandsatclouds(image) {
  var qa = image.select('BQA')
  var cloudBitMask = ee.Number(2).pow(4).int()
  var mask = qa.bitwiseAnd(cloudBitMask).eq(0)
  return image.updateMask(mask)
      .select("B.*")
      .copyProperties(image, ["system:time_start"])
}
//Landsat 5 TM, available from 1984-2012
//Tapping into the ee.ImageCollection for Landsat5
var L5 = ee.ImageCollection("LANDSAT/LT05/C01/T1_TOA") 
  .filterDate('2010-07-01', '2010-08-31') // Date range to use for imagery
  .filterBounds(geometry2)
  .map(maskLandsatclouds)
  .select(Landsat5BandCombo)
  
var Landsat5_mosaic = L5.median().clip(geometry2); // calculating median of each collection and clipping
Map.addLayer(Landsat5_mosaic, Landsat5Visualize, "Landsat5_mosaic")

Map.centerObject(geometry2)

// Edit the description to give output a name
Export.image.toDrive({ 
  image: Landsat5BandCombo,
  description: 'Landsat5_2010_July_August',  //Name your output
  scale: 30, 
  maxPixels: 1e13, 
  region: geometry2
});

```
![](/assets/gee.png)
  
 I should mention that you have to sign up for access to Earth Engine with your gmail account. Once you do, you should be able to go to the API sandbox  and play around.  Before you run the script, draw a polygon around the area you're interested in.  To export the data to your google drive, make sure you change the description section of the 'Export.image.toDrive()' function call above.  After that, kick off the actual download in the Tasks tab in the console widget (the top). 



Also... Earth Engine has a crop data raster. This raster gets made once a year by the USDA.  Since cell values range from 1-254 (in the cropLand Class table), this raster uses a pixel value to represent a crop type.  Here's the script for visualizing this data:
```
 var dataset = ee.ImageCollection('USDA/NASS/CDL')
                  .filter(ee.Filter.date('2010-01-01', '2010-12-31'))
                  .filterBounds(geometry)
                  .first();
                  
var slo_county = dataset.clip(geometry);
                  
var cropLandcover = slo_county.select('cropland');
Map.centerObject(geometry);
Map.addLayer(cropLandcover, {}, 'Crop Landcover');
```
